% This layout is similar to the one in differentiation-and-static-caching.tex
\begin{figure}[htb]
  \newcommand\vskipBeforeCatTitle{\\[-0.6em]}%
  \setlength{\arraycolsep}{0.3em}%
  \begin{minipage}[t]{\linewidth}%
      \begin{alignmath}*{c}
        \begin{array}[t]{rcl}
      %
      \categorytitle{CTS translation of values}{$\compile\sclosedvalue$}
      %
    \compile{\sclosure\sectx{\slam{\tx}{\sterm}}}
      & = &
            \tclosure{\compile\sectx}{\slam{\tx}{\tterm}} \\
      \side{\textrm{where } (\tcache, \tterm) = \compileterm{\tcachecons\temptycache\tx}\sterm}\\
      \\
      \compile{\sconst}
      & = &
            \sconst \\
      \nextline
      %
      \vskipBeforeCatTitle
      \categorytitle{CTS translation of change values}{$\compile\icloseddvalue$}
      %
      \compile{\sclosure\sdectx{\slam{\tx\,\tdx}{\iderive\sterm}}}
      & = &
            \tclosure{\compile\sdectx}{\slam{\tdx\, \tcache}{\derive{\tcachecons\temptycache{(\tchange{\tx}{\tdx})}}\sterm}} \\
      \side{\textrm{where } (\tcache, \tterm) = \compileterm{\tcachecons\temptycache\tx}\sterm}\\
      \\
      \compile{\replace\sclosedvalue}
      & = &
            \replace{\compile\sclosedvalue}
      \\
      \nextline
      \compile{\tdconst}
      & = &
          \tdconst\\ \nextline \vskipBeforeCatTitle
      \categorytitle{CTS translation of value environments}{$\compile\sectx$}
      %
      \compile{\sectxempty}
      & = &
            \tectxempty
      \\
      \nextline
      \compile{\sectxcons{\sectx}{\tx = \sclosedvalue}}
      & = &
            \sectxcons{\compile\sectx}{\tx = \compile\sclosedvalue}
      \\
      \nextline
      \vskipBeforeCatTitle
      \categorytitle{CTS translation of change environments}{$\compile\iectx$}
      %
      \compile{\sectxempty}
      & = &
            \tectxempty
      \\
      \nextline
      \compile{\sectxcons{\iectx}{\tx = \sclosedvalue, \tdx = \icloseddvalue}}
      & = &
            \sectxcons{\compile\iectx}{\tx = \compile\sclosedvalue, \tdx = \compile\icloseddvalue}
        \end{array}
      \end{alignmath}%
\end{minipage}
\caption{Extending CTS translation to values, change values, environments and change environments.}
\label{fig:differentiation-and-static-caching-continued}
\end{figure}
