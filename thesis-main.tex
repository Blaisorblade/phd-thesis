\documentclass[a4paper]{book}
\bibliographystyle{plainnat}

% lhs2TeX setup
\usepackage{mylhs2tex}
\input{packages}
\input{macros}

\usepackage{listings}
\input{lstsetup}

\input{aosd13/customMacros}
\input{pldi14/customMacros}

\input{pldi14/macros_part2}
% from pldi14
\newcommand{\ILC}{ILC}
% from aosd13
\usepackage{comment}
\excludecomment{extraEval}
\includecomment{techrep}
\excludecomment{nontechrep}
\includecomment{forNonBeamer}

% For adapting to compiling the whole thesis, or only parts.
\newtoggle{full}
\togglefalse{full}
%\toggletrue{full}

\newtoggle{poplAsChapter}
\togglefalse{poplAsChapter} % For dev.

\iftoggle{full}{
\includecomment{fullCompile}
\excludecomment{partCompile}
\toggletrue{poplAsChapter}
}{% else
\excludecomment{fullCompile}
\includecomment{partCompile}
}

% Conditional compilation across thesis and POPL18. With multiple commands.
\newtoggle{poplForThesis}
\toggletrue{poplForThesis}

% FROM POPL18
\usepackage{popl18/thesis-defs}
\usepackage{syntaxmacros,multicol}
% HEAVYWEIGHT, enable as late as possible.
\iftoggle{full}{
\usepackage{tikz}
\usepackage{pgfplots}
}{
\usepackage{xcolor}
}


% Number floats and figures together. Documented at
% http://stackoverflow.com/a/43266057/53974.
\makeatletter
\let\c@table\c@figure
\let\ftype@table\ftype@figure
\makeatother
\title{Optimizing and Incrementalizing Collection Queries by AST Transformations}
\author{Paolo G. Giarrusso}

\iftoggle{full}{
}{%else
% Only for development.
%
% Requires that other files are compiled with include, and can only be used in
% incremental runs: a first run has to be made without includeonly.
%
%\includeonly{aosd13/graphs/evalResLos,aosd13/paperBody}
%\includeonly{pldi14/sec-preliminaries,chap-intro-incr,chap-diff-correct-formal,chap-chs,pldi14/sec-intro,new-stuff}
%\includeonly{pldi14/sec-preliminaries,chap-intro-incr,chap-diff-correct-formal,chap-chs,pldi14/sec-intro}
%\includeonly{pldi14/sec-preliminaries,chap-intro-incr,chap-diff-correct-formal,chap-chs}
%\includeonly{pldi14/sec-preliminaries}
%\includeonly{chap-intro-incr}
%\includeonly{pldi14/sec-preliminaries,chap-diff-correct-formal}
%\includeonly{pldi14/sec-intro}

%\includeonly{chap-towards-sysf}
%\includeonly{}
%\includeonly{chap-intro}
\includeonly{chap-diff-examples}
%\includeonly{chap-intro,chap-intro-incr,chap-diff-examples}
%\includeonly{chap-diff-examples,new-stuff}

%\includeonly{pldi14/sec-preliminaries,chap-diff-correct-formal,chap-chs,chap-operationally}
%\includeonly{chap-operationally,popl18/formalization}

%\includeonly{pldi14/sec-preliminaries,chap-intro-incr,pldi14/sec-intro,new-stuff}

%\includeonly{chap-intro-incr,new-stuff,pldi14/sec-rw}
%\includeonly{chap-operationally,pldi14/sec-intro}
%\includeonly{new-stuff}
%\includeonly{chap-diff-correct-formal,pldi14/sec-intro}
%\includeonly{pldi14/sec-intro,new-stuff}
%\includeonly{aosd13/graphs/evalResLos,aosd13/paperBody,pldi14/sec-intro,backmatter}
}
%
% Also, include can add extra page breaks, so maybe switch back to input at the end.
% From http://web.science.mq.edu.au/~rdale/resources/writingnotes/latexstruct.html.
\input{pldi14/agda}
\begin{document}

\frontmatter
\input{TitlePage}

\iftoggle{full}{

\cleardoublepage
\section*{Abstract}
% Programs manipulating data collections require

% \begin{abstract}
% \end{abstract}
\cleardoublepage
\tableofcontents
\cleardoublepage
\listoffigures
\cleardoublepage
\listoftables
}{}

\mainmatter
\include{chap-intro}

\part{Optimizing Collection Queries by Reification}
\label{part:ch-aosd13}

\include{aosd13/graphs/evalResLos}
\include{aosd13/paperBody}


\part{Incremental λ-Calculus}
\label{part:incr}
\include{pldi14/sec-preliminaries}
\include{chap-intro-incr}
\include{chap-diff-examples}
\include{chap-diff-correct-formal}
\include{chap-chs}
\include{chap-eq-reason}
\include{chap-th-extensions}

\include{chap-towards-sysf}
\include{chap-operationally}

\include{pldi14/sec-practice}

\include{pldi14/sec-rw}
\include{pldi14/sec-concl}

\part{Incremental λ-Calculus in Cache-Transfer Style}
\label{part:caching}

\iftoggle{poplAsChapter}{
\include{popl18-sections}
}{
\newcommand{\poplPath}[1]{popl18/#1}
\chapter{Static memoization by cache-transfer-style conversion}
\label{ch:cts}
\include{popl18/cts-intro}
\include{popl18/cts-motivation}
\include{popl18/formalization}
\include{popl18/cts-case-studies}
\include{popl18/cts-relwork}
\include{popl18/cts-conclusion}
}

\include{defunc}
\include{new-stuff}

% \chapter{Conclusions}
% \pg{Plan for things that complete the original paper's story: add them by
%   revising that text and in that chapter.}

% Show Bibliography in TOC, % from https://tex.stackexchange.com/a/98995/1340
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}

% Use include on the \bibliography line avoids always typesetting the bibliography.

\include{backmatter}
\backmatter
\include{biblio}
\end{document}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
